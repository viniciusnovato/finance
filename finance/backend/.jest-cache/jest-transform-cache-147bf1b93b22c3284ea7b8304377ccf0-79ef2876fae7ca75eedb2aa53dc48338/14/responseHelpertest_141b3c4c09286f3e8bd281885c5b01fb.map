{"version":3,"names":["ResponseHelper","require","HttpStatusCodes","createMockResponse","res","status","jest","fn","mockReturnThis","json","statusCode","jsonData","mockImplementation","code","data","describe","mockRes","beforeEach","test","id","name","sendSuccess","expect","toHaveBeenCalledWith","OK","success","timestamp","any","String","CREATED","toBe","toBeDefined","BAD_REQUEST","message","sendError","error","details","field","issue","toEqual","validationErrors","sendValidationError","UNPROCESSABLE_ENTITY","pagination","page","totalPages","totalItems","limit","sendPaginatedResponse","currentPage","itemsPerPage","hasNextPage","hasPreviousPage","sendNotFound","NOT_FOUND","sendConflict","CONFLICT","sendUnauthorized","UNAUTHORIZED","sendForbidden","FORBIDDEN","sendInternalError","INTERNAL_SERVER_ERROR","sendNoContent","NO_CONTENT","result","formatPagination"],"sources":["responseHelper.test.js"],"sourcesContent":["/**\n * Testes unitários para ResponseHelper\n * Testa todas as respostas HTTP padronizadas\n */\n\nconst { ResponseHelper } = require('../../utils/responseHelper');\nconst { HttpStatusCodes } = require('../../utils/constants');\n\n// Mock do objeto response do Express\nconst createMockResponse = () => {\n  const res = {\n    status: jest.fn().mockReturnThis(),\n    json: jest.fn().mockReturnThis(),\n    statusCode: null,\n    jsonData: null\n  };\n  \n  // Capturar os dados enviados\n  res.status.mockImplementation((code) => {\n    res.statusCode = code;\n    return res;\n  });\n  \n  res.json.mockImplementation((data) => {\n    res.jsonData = data;\n    return res;\n  });\n  \n  return res;\n};\n\ndescribe('ResponseHelper', () => {\n  let mockRes;\n\n  beforeEach(() => {\n    mockRes = createMockResponse();\n  });\n\n  describe('sendSuccess', () => {\n    test('should send success response with data', () => {\n      const data = { id: 1, name: 'Test' };\n      \n      ResponseHelper.sendSuccess(mockRes, data);\n      \n      expect(mockRes.status).toHaveBeenCalledWith(HttpStatusCodes.OK);\n      expect(mockRes.json).toHaveBeenCalledWith({\n        success: true,\n        timestamp: expect.any(String),\n        id: 1,\n        name: 'Test'\n      });\n    });\n\n    test('should use custom status code when provided', () => {\n      const data = { id: 1 };\n      \n      ResponseHelper.sendSuccess(mockRes, data, HttpStatusCodes.CREATED);\n      \n      expect(mockRes.status).toHaveBeenCalledWith(HttpStatusCodes.CREATED);\n    });\n\n    test('should handle empty data', () => {\n      ResponseHelper.sendSuccess(mockRes);\n      \n      expect(mockRes.jsonData.success).toBe(true);\n      expect(mockRes.jsonData.timestamp).toBeDefined();\n    });\n  });\n\n  describe('sendError', () => {\n    test('should send error response', () => {\n      const statusCode = HttpStatusCodes.BAD_REQUEST;\n      const message = 'Erro de validação';\n      const code = 'VALIDATION_ERROR';\n      \n      ResponseHelper.sendError(mockRes, statusCode, message, code);\n      \n      expect(mockRes.status).toHaveBeenCalledWith(statusCode);\n      expect(mockRes.json).toHaveBeenCalledWith({\n        success: false,\n        error: {\n          message,\n          code,\n          timestamp: expect.any(String)\n        }\n      });\n    });\n\n    test('should include details when provided', () => {\n      const details = { field: 'email', issue: 'invalid format' };\n      \n      ResponseHelper.sendError(mockRes, HttpStatusCodes.BAD_REQUEST, 'Error', 'CODE', details);\n      \n      expect(mockRes.jsonData.error.details).toEqual(details);\n    });\n  });\n\n  describe('sendValidationError', () => {\n    test('should send validation error response', () => {\n      const validationErrors = [\n        { field: 'email', message: 'Email inválido' },\n        { field: 'name', message: 'Nome obrigatório' }\n      ];\n      \n      ResponseHelper.sendValidationError(mockRes, validationErrors);\n      \n      expect(mockRes.status).toHaveBeenCalledWith(HttpStatusCodes.UNPROCESSABLE_ENTITY);\n      expect(mockRes.jsonData.error.code).toBe('VALIDATION_ERROR');\n      expect(mockRes.jsonData.error.details.validationErrors).toEqual(validationErrors);\n    });\n  });\n\n  describe('sendPaginatedResponse', () => {\n    test('should send paginated response', () => {\n      const data = [{ id: 1 }, { id: 2 }];\n      const pagination = {\n        page: 1,\n        totalPages: 5,\n        totalItems: 50,\n        limit: 10\n      };\n      \n      ResponseHelper.sendPaginatedResponse(mockRes, data, pagination);\n      \n      expect(mockRes.status).toHaveBeenCalledWith(HttpStatusCodes.OK);\n      expect(mockRes.jsonData.data).toEqual(data);\n      expect(mockRes.jsonData.pagination).toEqual({\n        currentPage: 1,\n        totalPages: 5,\n        totalItems: 50,\n        itemsPerPage: 10,\n        hasNextPage: true,\n        hasPreviousPage: false\n      });\n    });\n  });\n\n  describe('sendNotFound', () => {\n    test('should send not found response', () => {\n      ResponseHelper.sendNotFound(mockRes, 'Cliente');\n      \n      expect(mockRes.status).toHaveBeenCalledWith(HttpStatusCodes.NOT_FOUND);\n      expect(mockRes.jsonData.error.message).toBe('Cliente não encontrado');\n    });\n  });\n\n  describe('sendConflict', () => {\n    test('should send conflict response', () => {\n      ResponseHelper.sendConflict(mockRes, 'Email');\n      \n      expect(mockRes.status).toHaveBeenCalledWith(HttpStatusCodes.CONFLICT);\n      expect(mockRes.jsonData.error.message).toBe('Email já existe');\n    });\n  });\n\n  describe('sendUnauthorized', () => {\n    test('should send unauthorized response', () => {\n      ResponseHelper.sendUnauthorized(mockRes);\n      \n      expect(mockRes.status).toHaveBeenCalledWith(HttpStatusCodes.UNAUTHORIZED);\n      expect(mockRes.jsonData.error.message).toBe('Acesso não autorizado');\n    });\n  });\n\n  describe('sendForbidden', () => {\n    test('should send forbidden response', () => {\n      ResponseHelper.sendForbidden(mockRes);\n      \n      expect(mockRes.status).toHaveBeenCalledWith(HttpStatusCodes.FORBIDDEN);\n      expect(mockRes.jsonData.error.message).toBe('Acesso proibido');\n    });\n  });\n\n  describe('sendInternalError', () => {\n    test('should send internal error response', () => {\n      ResponseHelper.sendInternalError(mockRes);\n      \n      expect(mockRes.status).toHaveBeenCalledWith(HttpStatusCodes.INTERNAL_SERVER_ERROR);\n      expect(mockRes.jsonData.error.message).toBe('Erro interno do servidor');\n    });\n  });\n\n  describe('sendNoContent', () => {\n    test('should send no content response', () => {\n      ResponseHelper.sendNoContent(mockRes);\n      \n      expect(mockRes.status).toHaveBeenCalledWith(HttpStatusCodes.NO_CONTENT);\n    });\n  });\n\n  describe('formatPagination', () => {\n    test('should format pagination correctly', () => {\n      const result = ResponseHelper.formatPagination(2, 10, 25);\n      \n      expect(result).toEqual({\n        page: 2,\n        limit: 10,\n        totalItems: 25,\n        totalPages: 3,\n        hasNextPage: true,\n        hasPreviousPage: true\n      });\n    });\n\n    test('should handle first page correctly', () => {\n      const result = ResponseHelper.formatPagination(1, 10, 25);\n      \n      expect(result.hasPreviousPage).toBe(false);\n      expect(result.hasNextPage).toBe(true);\n    });\n\n    test('should handle last page correctly', () => {\n      const result = ResponseHelper.formatPagination(3, 10, 25);\n      \n      expect(result.hasPreviousPage).toBe(true);\n      expect(result.hasNextPage).toBe(false);\n    });\n  });\n});"],"mappings":"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","ignoreList":[]}